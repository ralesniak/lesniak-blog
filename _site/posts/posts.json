[
  {
    "path": "posts/2021-06-08-tidy-tuesday/",
    "title": "tidy-tuesday",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Rachel Lesniak",
        "url": {}
      }
    ],
    "date": "2021-06-08",
    "categories": [
      "tidy tuesday"
    ],
    "contents": "\nDistill is a publication format for scientific and technical writing, native to the web.\nLearn more about using Distill at https://rstudio.github.io/distill.\n\n\n\n",
    "preview": {},
    "last_modified": "2021-06-08T21:15:06-04:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-09-19-viz-makeover/",
    "title": "Viz Makeover: Survey of Public Transit Agencies",
    "description": "Making over a viz from APTA",
    "author": [],
    "date": "2020-09-19",
    "categories": [
      "viz"
    ],
    "contents": "\nContext and audience mean so much for data visualization. On Twitter, I sometimes see charts that have great information but aren’t optimized for the Twitter experience. Some common missed opportunities:\nThey’re too big, so the Twitter crop hides the important parts\nThe title doesn’t give the big idea, so it’s easy to scroll on by\nThe viz doesn’t take advantage of branding to associate the analysis with the organization\nSometimes I’m inspired to make charts over to be more Twitter-friendly, mostly for my own fun. Here’s one I did using a survey of American public transit agencies by the American Public Transportation Association.\nSetup\nI’m only using three packages today - tidyverse as the anchor, showtext for custom fonts, and ggtext for colorizing the category labels.\nThe original viz had the data points in the image, so I made a quick tribble to capture the data.\n\n\nlibrary(tidyverse)\nlibrary(showtext)\nlibrary(ggtext)\n\n#Fonts\nfont_add_google(name = \"Roboto\", family = \"roboto\")\nfont_add_google(name = \"Rubik\", family = \"rubik\")\nshowtext_auto()\n\n# APTA Data\n\napta_data <- tibble::tribble(\n                                    ~category, ~value,\n                           \"Eliminate Routes\",   0.38,\n                     \"Reduce Days of Service\",   0.20,\n                                \"Cut Service\",   0.61,\n                             \"Furlough Staff\",   0.23,\n                              \"Lay Off Staff\",   0.31,\n                             \"Increase Fares\",   0.17,\n  \"Delay, Defer, or Cancel Vehicle Purchases\",   0.33,\n   \"Delay, Defer, or Cancel Capital Projects\",   0.45\n  )\n\n\n\nOrganize data\nI love using ggtext to make the category labels pop, but it takes a tiny bit of set up.\nFirst, I name all the colors, which I copied from the APTA website to match the branding.\nThen, I mutate() to make a highlight column to specify the color.\nA second mutate() plus some basic HTML makes a new label column that will be called in the chart.\nI also fct_reorder() the data based on percentage value.\n\n\n# colors\nbg_gray <- \"#F5F5F5\"\naxis_line_gray <- \"#B8B8B8\"\nother_gray <- \"#474747\"\n\nhighlight_1 <- \"#650533\" #apta maroon\nhighlight_2 <- \"#094279\" #apta blue\n\n#add in new columns re: color and labels\n\nplot_data <- apta_data %>%\n  mutate(\n    highlight = case_when(\n      category == \"Cut Service\" ~ highlight_1,\n      str_detect(category, \"Capital\") ~ highlight_2,\n      TRUE ~   other_gray\n    ),\n    category_label = \n      glue::glue(\"<span style ='color:{highlight}'>{category}<\/span>\"),\n    category_label = fct_reorder(category_label, value)\n  )\n\n\n\nPlotting\nNow it’s time to make a chart!\nI kept the column chart style and kept the value on the x-axis.\nThe y-axis became the category_label and requires element_markdown() in the theme to render the HTML.\nThen, for the fill, I used the highlight column along with scale_fill_identity(). The bars also print from largest to smallest value because of the factor created in the step above.\nA big title and subtitle explain the chart. It took some trial and error to get the right size font plus using <br> for some manual spacings. These also require element_markdown() in the theme.\nI use some custom Google fonts to spice up the default san serif.\n\n\n# the chart!\nnew_plot <- plot_data %>%\n  ggplot(aes(x = value, y = category_label, fill = highlight)) +\n  geom_col() +\n  scale_x_continuous(labels = scales::percent_format()) +\n  scale_fill_identity() +\n  labs(title = glue::glue(\"Without emergency funding from Congress, \n  your transit agency<br>might <span style='color:{highlight_1}'>cut \n  service<\/span> or <span style='color:{highlight_2}'>delay \n  infrastructure projects<\/span>\"),\n       subtitle = \"Percent of transit agencies that said they were \n                  considering the following actions\",\n       caption = \"n = 128<br>Source: APTA.com, Sep 2020\") +\n  theme_classic(base_size = 12) +\n  theme(\n    #align title left\n    plot.title.position = \"plot\",\n    #colors and fonts\n    text = element_text(family = \"rubik\"),\n    plot.background = element_rect(fill = bg_gray),\n    panel.background = element_rect(fill = bg_gray,\n                                    colour = bg_gray),\n    axis.line = element_line(color = axis_line_gray),\n    plot.title = element_markdown(family = \"roboto\", \n                                  face = \"bold\"),\n    plot.subtitle = element_markdown(family = \"roboto\"),\n    plot.caption = element_markdown(), \n    axis.text.y = element_markdown(),\n    #no annoying stuff\n    axis.title = element_blank(),\n    legend.position = \"none\"\n    )\n\nnew_plot\n\n\n\n\nI’m pretty happy with this! I wish APTA colors were a little more dynamic, but this chart gets the main idea across faster.\nExport\nThen, to export, a blank PNG is created and the plot is printed on top. This is different than ggsave() because of the custom fonts. I made the PNG the size of the Twitter cropped image so nothing would be lost.\n\n\n# Export Plot\n\n# {showtext} requires these steps, no ggsave available\n\npng(filename = \"new_plot.png\",\n    width = 600,\n    height = 335)\nnew_plot\ndev.off()\n\n\n\n\n\n\n",
    "preview": "posts/2020-09-19-viz-makeover/2020-09-19-viz-makeover_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2021-07-18T14:01:18-04:00",
    "input_file": {},
    "preview_width": 1248,
    "preview_height": 768
  }
]
